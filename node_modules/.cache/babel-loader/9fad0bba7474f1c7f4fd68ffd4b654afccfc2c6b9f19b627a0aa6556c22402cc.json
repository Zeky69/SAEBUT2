{"ast":null,"code":"import { items, shopusers } from './data';\nimport { v4 as uuidv4 } from 'uuid';\nimport { bankaccounts } from './data';\nimport { transactions } from './data';\n\n/* controllers: les fonctions ci-dessous doivent mimer ce que renvoie l'API en fonction des requêtes possibles.\n\n  Dans certains cas, ces fonctions vont avoir des paramètres afin de filtrer les données qui se trouvent dans data.js\n  Ces paramètres sont généralement les mêmes qu'ils faudrait envoyer à l'API, mais pas forcément.\n\n  Exemple 1 : se loguer aurpès de la boutique\n\n\n */\n\nfunction shopLogin(data) {\n  if (!data.login || !data.password) return {\n    error: 1,\n    status: 404,\n    data: 'aucun login/pass fourni'\n  };\n  let user = shopusers.find(e => e.login === data.login);\n  if (!user) return {\n    error: 1,\n    status: 404,\n    data: 'login/pass incorrect'\n  };\n  // générer un uid pour l'utilisateur si non existant\n  if (!user.uuid) {\n    user.uuid = uuidv4();\n  }\n  return {\n    error: 0,\n    status: 200,\n    data: user\n  };\n}\nfunction getAllViruses() {\n  return {\n    error: 0,\n    data: items\n  };\n}\nfunction getAccountAmount(number) {\n  if (!number) return {\n    error: 1,\n    status: 404,\n    data: 'aucun numéro de compte fourni'\n  };\n  let account = bankaccounts.find(e => e.number === number);\n  if (!account) return {\n    error: 1,\n    status: 404,\n    data: 'compte inconnu'\n  };\n  return {\n    error: 0,\n    data: account.amount\n  };\n}\nfunction getTransactionsofAccount(number) {\n  if (!number) return {\n    error: 1,\n    status: 404,\n    data: 'Aucun numéro de compte fourni'\n  };\n  let account = bankaccounts.find(e => e.number === number);\n  if (!account) return {\n    error: 1,\n    status: 404,\n    data: 'Compte inconnu'\n  };\n  let transactionsList = transactions.filter(e => e.account === account._id);\n  if (!transactionsList || transactionsList.length === 0) {\n    return {\n      error: 1,\n      status: 404,\n      data: 'Aucune transaction pour ce compte'\n    };\n  }\n\n  // Utilisez map pour extraire les montants et les dates des transactions et les stocker dans un tableau d'objets.\n  let transactionData = transactionsList.map(transaction => {\n    return {\n      amount: transaction.amount,\n      date: transaction.date.$date // Vous pouvez accéder à la date de cette manière si c'est une chaîne de caractères.\n    };\n  });\n\n  console.log(transactionData);\n  console.log(transactionData[0]);\n  console.log(\"test\");\n  return {\n    error: 0,\n    data: transactionData\n  };\n}\nexport default {\n  shopLogin,\n  getAllViruses,\n  getAccountAmount,\n  getTransactionsofAccount\n};","map":{"version":3,"names":["items","shopusers","v4","uuidv4","bankaccounts","transactions","shopLogin","data","login","password","error","status","user","find","e","uuid","getAllViruses","getAccountAmount","number","account","amount","getTransactionsofAccount","transactionsList","filter","_id","length","transactionData","map","transaction","date","$date","console","log"],"sources":["/home/kalinux/Calixte/BUT2/devWeb/frontend/TP/drmad/src/datasource/controller.js"],"sourcesContent":["import { items, shopusers } from './data'\nimport {v4 as uuidv4} from 'uuid'\nimport { bankaccounts} from './data'\nimport { transactions} from './data'\n\n/* controllers: les fonctions ci-dessous doivent mimer ce que renvoie l'API en fonction des requêtes possibles.\n\n  Dans certains cas, ces fonctions vont avoir des paramètres afin de filtrer les données qui se trouvent dans data.js\n  Ces paramètres sont généralement les mêmes qu'ils faudrait envoyer à l'API, mais pas forcément.\n\n  Exemple 1 : se loguer aurpès de la boutique\n\n\n */\n\nfunction shopLogin(data) {\n  if ((!data.login) || (!data.password)) return {error: 1, status: 404, data: 'aucun login/pass fourni'}\n  let user = shopusers.find(e => e.login === data.login)\n  if (!user) return {error: 1, status: 404, data: 'login/pass incorrect'}\n  // générer un uid pour l'utilisateur si non existant\n  if (!user.uuid) {\n    user.uuid = uuidv4()\n  }\n  return {error: 0, status: 200, data: user}\n}\n\nfunction getAllViruses() {\n  return {error: 0, data: items}\n}\n\n\nfunction getAccountAmount(number) {\n  if (!number) return {error: 1, status: 404, data: 'aucun numéro de compte fourni'}\n  let account = bankaccounts.find(e => e.number === number)\n  if (!account) return {error: 1, status: 404, data: 'compte inconnu'}\n  return {error: 0, data: account.amount}\n}\n\nfunction getTransactionsofAccount(number) {\n    if (!number) return { error: 1, status: 404, data: 'Aucun numéro de compte fourni' }\n\n    let account = bankaccounts.find(e => e.number === number);\n    if (!account) return { error: 1, status: 404, data: 'Compte inconnu' }\n\n    let transactionsList = transactions.filter(e => e.account === account._id);\n\n    if (!transactionsList || transactionsList.length === 0) {\n        return { error: 1, status: 404, data: 'Aucune transaction pour ce compte' };\n    }\n\n    // Utilisez map pour extraire les montants et les dates des transactions et les stocker dans un tableau d'objets.\n    let transactionData = transactionsList.map(transaction => {\n        return {\n            amount: transaction.amount,\n            date: transaction.date.$date // Vous pouvez accéder à la date de cette manière si c'est une chaîne de caractères.\n        };\n    });\n    console.log(transactionData);\n    console.log(transactionData[0])\n    console.log(\"test\")\n    return { error: 0, data: transactionData };\n}\n\n\n\nexport default{\n  shopLogin,\n  getAllViruses,\n  getAccountAmount,\n  getTransactionsofAccount,\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}